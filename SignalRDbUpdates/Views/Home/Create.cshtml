@model SignalRDbUpdates.Models.Messages

@{
    ViewBag.Title = "Create";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>Create</h2>


@using (Html.BeginForm()) 
{
    //@Html.AntiForgeryToken()
    
    <div class="form-horizontal">
        <h4>Messages</h4>
        <hr />
        @Html.ValidationSummary(true, "", new { @class = "text-danger" })
        <div class="form-group">
            @Html.LabelFor(model => model.CampaignName, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.CampaignName, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(model => model.CampaignName, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group">
            @Html.LabelFor(model => model.MessageDate, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.MessageDate, new { htmlAttributes = new { @class = "form-control" ,@type="date"} })
                @Html.ValidationMessageFor(model => model.MessageDate, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group">
            @Html.LabelFor(model => model.Clicks, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.Clicks, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(model => model.Clicks, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group">
            @Html.LabelFor(model => model.Conversions, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.Conversions, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(model => model.Conversions, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group">
            @Html.LabelFor(model => model.Impressions, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.Impressions, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(model => model.Impressions, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group">
            @Html.LabelFor(model => model.AffiliateName, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.AffiliateName, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(model => model.AffiliateName, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group">
            <div class="col-md-offset-2 col-md-10">
                <input type="button" value="Create" id="btnSubmit" onclick="createUser()" class="btn btn-default" />
            </div>
        </div>
    </div>
}

<div>
    @Html.ActionLink("Back to List", "Index")
</div>
<script src="~/Scripts/jquery-1.10.2.min.js"></script>

@section Scripts{
<script src="~/Scripts/jquery.signalR-2.1.1.js"></script>
<!--Reference the autogenerated SignalR hub script. -->
<script src="/signalr/hubs"></script>
<script type="text/javascript">
    $(function () {
        // Declare a proxy to reference the hub.
        var notifications = $.connection.messagesHub;

        //debugger;
        // Create a function that the hub can call to broadcast messages.
        //notifications.client.updateMessages = function () {
        //    getAllMessages()

        //};
        // Start the connection.
        $.connection.hub.start()//.done(function () {
        //    //alert("connection started")
        //    getAllMessages();
        //}).fail(function (e) {
        //    alert(e);
        //});
    });

    function createUser() {
        debugger;
        var CampaignName = $("#CampaignName").val();
        var MessageDate = $("#MessageDate").val();
        var Clicks = $("#Clicks").val();
        var Conversions = $("#Conversions").val();
        var Impressions = $("#Impressions").val();
        var AffiliateName = $("#AffiliateName").val();

        $.ajax({
            url: '@Url.Action("Create", "Home")',
            type: "POST",
            data: {
                "CampaignName": CampaignName,
                "MessageDate": MessageDate,
                "Clicks": Clicks,
                "Conversions": Conversions,
                "Impressions": Impressions,
                "AffiliateName": AffiliateName,
            }
            //suceess: function (data) {
            //    debugger;
            //    if (data.data == "Success") {
            //        alert("Record has been Created successfully");
            //        window.location.href = '/Home/Index';
            //    }
            //    else {
            //        alert("Error get Generated");
            //    }
            //},
            //error: function () {
            //    alert("Error get Generated");
            //}
        });
        alert("Record has been Created successfully.");
        $("#CampaignName").val('');
        $("#MessageDate").val('');
        $("#Clicks").val('');
        $("#Conversions").val('');
        $("#Impressions").val('');
        $("#AffiliateName").val('');
    }


</script>
    }

@*<script src="~/Scripts/jquery-1.10.2.js"></script>*@
@*<script src="~/Scripts/jquery-1.10.2.min.js"></script>
<script type="text/javascript">
    $(document).ready(function () {
        function createUser(){
            var CampaignName = $("#CampaignName").val();
            var MessageDate = $("#MessageDate").val();
            var Clicks = $("#Clicks").val();
            var Conversions = $("#Conversions").val();
            var Impressions = $("#Impressions").val();
            var AffiliateName = $("#AffiliateName").val();

            $.ajax({
                type: "POST",
                url: "/Home/Create",
                data: {
                    "CampaignName": CampaignName,
                    "MessageDate": MessageDate,
                    "Clicks": Clicks,
                    "Conversions": Conversions,
                    "Impressions": Impressions,
                    "AffiliateName": AffiliateName
                },
                dataType: 'Json',
                suceess: function (data) {
                    if (data.data == "Success") {
                        $("#CampaignName").val('');
                        $("#MessageDate").val('');
                        $("#Clicks").val('');
                        $("#Conversions").val('');
                        $("#Impressions").val('');
                        $("#AffiliateName").val('');
                    }
                    else {
                        alert("Error get Generated");
                    }
                },
                error: function () {
                    alert("Error get Generated");
                }
            });
        }
    });
</script>*@
